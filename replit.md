# MusicStream - Music Streaming Platform

## Overview

MusicStream is a music streaming web application inspired by Spotify, Apple Music, and YouTube Music. The platform integrates with YouTube's API to provide music search and playback capabilities, allowing users to create playlists, discover music, and manage their listening experience. The application features a dark-mode-first design with dynamic color extraction from album artwork, providing an immersive visual experience.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture

**Framework & Build System**
- **React with TypeScript**: Component-based UI using functional components and hooks
- **Vite**: Fast build tool and development server with HMR (Hot Module Replacement)
- **Wouter**: Lightweight client-side routing library for navigation
- **TanStack Query (React Query)**: Server state management, caching, and data fetching

**UI Component System**
- **Shadcn/ui**: Headless component library built on Radix UI primitives
- **Tailwind CSS**: Utility-first styling with custom design tokens
- **Custom Design System**: Based on the "new-york" style with Portuguese language support
- **Responsive Design**: Mobile-first approach with breakpoint-based layouts

**State Management Strategy**
- **Context API**: Used for cross-cutting concerns (authentication, music player state)
- **React Query**: Server state and cache management
- **Local Component State**: For UI-specific state using useState/useReducer

**Key Design Decisions**
- Dark mode as default with optional light mode support
- Dynamic color theming extracted from album artwork
- Typography hierarchy using Inter (interface), Outfit (display), and JetBrains Mono (monospace)
- Component-based architecture with clear separation of concerns

### Backend Architecture

**Server Framework**
- **Express.js**: Node.js web framework handling HTTP requests
- **TypeScript**: Type-safe server-side code with ES modules
- **Session Management**: Express-session with PostgreSQL session store (connect-pg-simple)

**API Design**
- **RESTful Endpoints**: Organized by resource (auth, playlists, users, YouTube)
- **Session-based Authentication**: HTTP-only cookies for secure authentication
- **Middleware Pattern**: Request logging, authentication guards, error handling

**Authentication & Authorization**
- **bcrypt**: Password hashing (6.x with native bindings)
- **Session-based Auth**: Persistent sessions stored in PostgreSQL
- **Protected Routes**: Middleware-based authentication checks

**Key Architectural Patterns**
- Repository pattern for data access (DatabaseStorage class)
- Separation of routes, business logic, and data access
- Centralized error handling middleware
- Development-specific tooling (Vite integration, runtime error overlay)

### Data Storage

**Database**
- **PostgreSQL**: Relational database via Neon serverless
- **Drizzle ORM**: Type-safe database queries and schema management
- **Connection Pooling**: Neon serverless connection pooling with WebSocket support

**Schema Design**
- **users**: User accounts with credentials and metadata
- **playlists**: User-created playlists with privacy settings
- **playlistTracks**: Junction table storing YouTube video metadata within playlists
- **recentlyPlayed**: User listening history
- **user_sessions**: Express session storage (auto-created by connect-pg-simple)

**Data Model Patterns**
- UUID primary keys generated by PostgreSQL
- Cascade deletes for referential integrity
- Timestamp tracking for created/updated records
- Embedded YouTube metadata to reduce API calls

### External Dependencies

**Third-Party Services**

**YouTube Data API v3**
- **Purpose**: Music search and video metadata retrieval
- **Integration**: Google APIs client library with OAuth 2.0
- **Connection Management**: Replit Connectors system for credential management
- **Token Handling**: Automatic token refresh and expiration management
- **Usage**: Search queries return video IDs, titles, artists, thumbnails, and durations

**Replit Services**
- **Replit Connectors**: Manages YouTube API OAuth credentials
- **Development Tools**: Vite plugins for error overlay, cartographer, and dev banner
- **Deployment**: Configured for Replit's deployment infrastructure

**External Libraries**

**UI & Interaction**
- **Radix UI**: Headless accessible component primitives (~20 components)
- **Lucide React**: Icon library for consistent iconography
- **React Hook Form**: Form state management with Zod validation
- **date-fns**: Date manipulation and formatting
- **cmdk**: Command menu/palette component

**Development Tools**
- **Drizzle Kit**: Database migrations and schema push
- **ESBuild**: Production server bundling
- **PostCSS & Autoprefixer**: CSS processing

**Key Integration Decisions**
- YouTube API as primary music source (no local file storage)
- Metadata caching in PostgreSQL to reduce API calls
- OAuth token management delegated to Replit infrastructure
- Session persistence in PostgreSQL rather than memory stores